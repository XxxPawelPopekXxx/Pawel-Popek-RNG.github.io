<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paweł RNG</title>

<style>
body { 
  font-family: Arial; 
  background:#121212; 
  color:#fff; 
  text-align:center; 
  margin:0; 
  padding:0; 
}
h1 { margin-top:20px; font-size:2em; }

button { 
  padding:15px 30px; 
  font-size:1.2em; 
  margin:10px; 
  cursor:pointer; 
  border:none; 
  border-radius:10px; 
  transition:transform 0.2s; 
}
button:active { transform: scale(0.9); }

#rollButton { background-color:#4CAF50; color:white; }
#muteButton { background-color:#f44336; color:white; }
.upgradeButton { background-color:#2196F3; color:white; }

#resultImage { 
  width:300px; 
  height:300px; 
  margin:20px auto; 
  object-fit:cover; 
  border-radius:15px; 
  display:block; 
  transition:all 0.1s; 
}
#resultText { font-size:1.5em; margin-top:10px; }
#chanceText, #rarityText { font-size:1.2em; margin-top:5px; }

#currency { margin-top:20px; font-size:1.3em; }
#upgrades { 
  margin-top:20px; 
  font-size:1em; 
  display:flex; 
  flex-wrap:wrap; 
  justify-content:center; 
}
#upgrades button { margin:5px; }

#inventory, #history, #cooldownDisplay { 
  margin-top:15px; 
  font-size:1.1em; 
}
#history { 
  max-height:200px; 
  overflow-y:auto; 
  border:1px solid #555; 
  padding:10px; 
  border-radius:10px; 
  width:90%; 
  margin:10px auto; 
  background-color:#222; 
}

#stats { 
  position:fixed; 
  top:10px; 
  right:10px; 
  background-color:#222; 
  border:1px solid #555; 
  padding:10px; 
  border-radius:10px; 
  text-align:left; 
  width:250px; 
  font-size:0.9em; 
}

#resetOverlay { 
  display:none; 
  position:fixed; 
  top:0; left:0; 
  width:100%; height:100%; 
  background:rgba(0,0,0,0.8); 
  z-index:999; 
  color:white; 
  justify-content:center; 
  align-items:center; 
}
#resetBox { 
  background:#222; 
  padding:30px; 
  border-radius:15px; 
  text-align:center; 
  max-width:400px; 
}
#resetBox p { 
  font-size:1.5em; 
  color:red; 
  margin-bottom:20px; 
}
#resetBox button { 
  margin:10px; 
  padding:10px 20px; 
  font-size:1.2em; 
  border-radius:10px; 
  cursor:pointer; 
}
#resetYes { background-color:green; color:white; }
#resetNo { background-color:red; color:white; }

#volumeControl { margin-top:15px; }

#resetProgress { 
  position:fixed; 
  bottom:10px; 
  left:10px; 
  background-color:#f44336; 
  color:white; 
  padding:10px 15px; 
  border-radius:10px; 
  font-weight:bold; 
  cursor:pointer; 
}

#chanceList { 
  margin-top:10px; 
  font-size:0.9em; 
  color:#ccc; 
  text-align:left; 
  max-width:250px; 
  margin-left:auto; 
  margin-right:auto; 
}

#shopOverlay {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.75);
  z-index:1000;
  justify-content:center;
  align-items:center;
}
#shopBox {
  background:#222;
  padding:25px;
  border-radius:15px;
  width:360px;
  text-align:center;
}
.shopItem {
  border:1px solid #555;
  border-radius:10px;
  padding:10px;
  margin:10px 0;
}
.shopItem button {
  margin-top:5px;
  width:100%;
}
</style>
</head>

<body>

<h1>Paweł RNG</h1>

<div id="stats">
  <div>Monety: <span id="statsCoins">0</span></div>
  <div>Autorzy: KoleszkaPP i its4iko</div>
  <div>Play Time: <span id="statsPlayTime">0s</span></div>
  <div>Łączne losowania: <span id="statsRolls">0</span></div>
</div>

<img id="resultImage" src="photo.png" alt="Result">
<div id="resultText">Kliknij Roll</div>
<div id="chanceText"></div>
<div id="rarityText"></div>

<button id="rollButton">Roll</button>
<div id="cooldownDisplay">Cooldown: 3.0s</div>

<input type="range" min="0" max="100" value="100" id="volumeControl"> Głośność  
<br>
<button id="muteButton">Mute / Unmute</button>

<div id="currency">Monety: <span id="coins">0</span></div>
<button id="openShop" class="upgradeButton">Sklep</button>

<div id="upgrades">
  <button class="upgradeButton" id="shortenCooldown">
    Skróć cooldown (-0.5s) 50 monet
  </button>
  <button class="upgradeButton" id="increaseChances">
    Ulepszenie szans 100 monet
  </button>
  <button class="upgradeButton" id="buyItem">
    Kup Tajemniczy Przedmiot 100 monet
  </button>
  <button class="upgradeButton" id="toggleAutoRoll">
    Włącz Auto-Roll 5000 monet
  </button>
</div>

<div id="inventory">Ekwipunek: brak</div>
<div id="history">Historia losowań:</div>

<div id="resetProgress">RESET PROGRESS</div>

<div id="resetOverlay">
  <div id="resetBox">
    <p>Czy na pewno chcesz zresetować progres?</p>
    <button id="resetYes">Tak</button>
    <button id="resetNo">Nie</button>
  </div>
</div>

<div id="chanceList"></div>

<div id="shopOverlay">
  <div id="shopBox">
    <h2>Sklep Pawła</h2>

    <div class="shopItem">
      <b>Lucky Pawel (1.5x)</b><br>
      gejmingowy paweł x20<br>
      paweł prezydent x10<br>
      1000 monet
      <button onclick="buyShopItem('lucky')">Kup</button>
    </div>

    <div class="shopItem">
      <b>Mega Pawel (2x)</b><br>
      pawel w zoltym hoodie x25<br>
      funni paweł x15<br>
      2500 monet
      <button onclick="buyShopItem('mega')">Kup</button>
    </div>

    <div class="shopItem">
      <b>Ultimate Pawel (3x)</b><br>
      paweł ok x50<br>
      świąteczny paweł x20<br>
      paweł dostaje backshoty x2<br>
      paweł komunista x1<br>
      5000 monet
      <button onclick="buyShopItem('ultimate')">Kup</button>
    </div>

    <button onclick="closeShop()">Zamknij</button>
  </div>
</div>

<audio id="backgroundMusic" loop></audio>

<script>
// ===== DANE RNG (NAPRAWIONE STRINGI I SKŁADNIA) =====
const images = [
  {src:'photo.png',text:'gejmingowy paweł',chance:1/2,rarity:'Common',reward:1},
  {src:'photo2.png',text:'paweł prezydent',chance:1/4,rarity:'Uncommon',reward:3},
  {src:'photo3.png',text:'pawel w zoltym hoodie',chance:1/8,rarity:'Rare',reward:5},
  {src:'photo4.png',text:'funni paweł',chance:1/16,rarity:'Epic',reward:10},
  {src:'photo5.png',text:'paweł ok',chance:1/32,rarity:'Mythic',reward:20},
  {src:'photo6.png',text:'świąteczny paweł',chance:1/64,rarity:'Legendary',reward:40},
  {src:'photo7.png',text:'paweł dostaje backshoty',chance:1/128,rarity:'Ultra Legendary',reward:80},
  {src:'photo8.png',text:'paweł komunista',chance:1/256,rarity:'Ultra Legendary',reward:160},
  {src:'photo9.png',text:'Śledziu',chance:1/1e15,rarity:'Secret',reward:250,requiresItem:'Tajemniczy Przedmiot'}
];
// ===== MUZYKA =====
const musicFiles = ['music.mp3','music2.mp3','music3.mp3','music4.mp3','music5.mp3'];
const bgMusic = document.getElementById("backgroundMusic");
let musicStarted = false;

document.getElementById("muteButton").addEventListener("click",()=>{
  bgMusic.muted = !bgMusic.muted;
});

document.getElementById("volumeControl").addEventListener("input",(e)=>{
  bgMusic.volume = e.target.value/100;
});

// ===== ZMIENNE GRY =====
let coins = localStorage.getItem("coins") ? parseInt(localStorage.getItem("coins")) : 0;
let totalRolls = localStorage.getItem("totalRolls") ? parseInt(localStorage.getItem("totalRolls")) : 0;
let cooldown = localStorage.getItem("cooldown") ? parseInt(localStorage.getItem("cooldown")) : 3000;
let lastRoll = 0;
let inventory = localStorage.getItem("inventory") ? JSON.parse(localStorage.getItem("inventory")) : [];
let historyData = localStorage.getItem("historyData") ? JSON.parse(localStorage.getItem("historyData")) : {};
let autoRollEnabled = false;
let autoRollInterval = null;

// ===== UPDATE UI =====
function updateUI(){
  document.getElementById("coins").textContent = coins;
  document.getElementById("statsCoins").textContent = coins;
  document.getElementById("statsRolls").textContent = totalRolls;

  document.getElementById("inventory").textContent = inventory.length
    ? `Ekwipunek: ${inventory.join(", ")}`
    : "Ekwipunek: brak";

  let historyHTML = "";
  for(const [key,val] of Object.entries(historyData)){
    historyHTML += `${key} (x${val})<br>`;
  }
  document.getElementById("history").innerHTML = historyHTML || "Historia losowań: brak";

  localStorage.setItem("coins",coins);
  localStorage.setItem("totalRolls",totalRolls);
  localStorage.setItem("inventory",JSON.stringify(inventory));
  localStorage.setItem("historyData",JSON.stringify(historyData));
  localStorage.setItem("cooldown",cooldown);
}

// ===== COOLDOWN TIMER =====
setInterval(()=>{
  const now = Date.now();
  let remaining = lastRoll ? Math.max(0, cooldown - (now - lastRoll)) : 0;
  document.getElementById("cooldownDisplay").textContent = `Cooldown: ${(remaining/1000).toFixed(1)}s`;
},100);

// ===== LOSOWANIE =====
function rollRNG(){
  const now = Date.now();
  if(now - lastRoll < cooldown) return;
  lastRoll = now;
  totalRolls++;

  // start muzyki przy pierwszym kliknięciu
  if(!musicStarted){
    const randomMusic = musicFiles[Math.floor(Math.random()*musicFiles.length)];
    bgMusic.src = randomMusic;
    bgMusic.volume = document.getElementById("volumeControl").value/100;
    bgMusic.play().catch(()=>{});
    musicStarted = true;
  }

  const pool = [];
  images.forEach(img=>{
    if(img.requiresItem && !inventory.includes(img.requiresItem)) return;
    let count = Math.floor(img.chance * 1000000);
    for(let i=0;i<count;i++) pool.push(img);
  });

  const animImg = document.getElementById("resultImage");
  const animText = document.getElementById("resultText");
  const animChance = document.getElementById("chanceText");
  const animRarity = document.getElementById("rarityText");

  let elapsed = 0;
  const animInterval = setInterval(()=>{
    const temp = images[Math.floor(Math.random()*images.length)];
    animImg.src = temp.src;
    animText.textContent = temp.text;
    animChance.textContent = `Szansa: 1/${Math.round(1/temp.chance)}`;
    animRarity.textContent = `Rzadkość: ${temp.rarity}`;

    animImg.style.transform = `scale(${1+Math.random()*0.2}) rotate(${(Math.random()-0.5)*20}deg)`;

    elapsed += 50;
    if(elapsed >= 1000){
      clearInterval(animInterval);

      const selected = pool[Math.floor(Math.random()*pool.length)];
      animImg.src = selected.src;
      animText.textContent = selected.text;
      animChance.textContent = `Szansa: 1/${Math.round(1/selected.chance)}`;
      animRarity.textContent = `Rzadkość: ${selected.rarity}`;
      animImg.style.transform = "scale(1) rotate(0deg)";

      let reward = Math.floor(selected.reward * 0.5); // 50% mniej kasy
      coins += reward;

      historyData[selected.text] = (historyData[selected.text] || 0) + 1;

      updateUI();
    }
  },50);
}

document.getElementById("rollButton").addEventListener("click", rollRNG);

// ===== ULEPSZENIA =====
document.getElementById("shortenCooldown").addEventListener("click",()=>{
  if(coins >= 50 && cooldown > 1000){
    coins -= 50;
    cooldown -= 500;
    updateUI();
    alert(`Cooldown skrócony do ${(cooldown/1000).toFixed(1)}s`);
  } else alert("Nie masz monet lub cooldown już minimalny!");
});

document.getElementById("increaseChances").addEventListener("click",()=>{
  if(coins >= 100){
    coins -= 100;
    images.forEach(img=>{
      img.chance *= 1.05;
    });
    updateUI();
    alert("Szanse zwiększone!");
  } else alert("Nie masz monet!");
});

document.getElementById("buyItem").addEventListener("click",()=>{
  if(coins >= 100){
    if(!inventory.includes("Tajemniczy Przedmiot")){
      coins -= 100;
      inventory.push("Tajemniczy Przedmiot");
      updateUI();
      alert("Kupiono Tajemniczy Przedmiot!");
    } else alert("Już masz ten przedmiot!");
  } else alert("Nie masz monet!");
});

// ===== AUTOROLL =====
document.getElementById("toggleAutoRoll").addEventListener("click",()=>{
  if(autoRollEnabled){
    clearInterval(autoRollInterval);
    autoRollEnabled = false;
    alert("Auto-Roll wyłączony");
  } else {
    if(coins >= 5000){
      coins -= 5000;
      autoRollEnabled = true;
      autoRollInterval = setInterval(rollRNG,1500);
      alert("Auto-Roll włączony");
    } else alert("Nie masz monet!");
  }
  updateUI();
});

// ===== RESET =====
const resetOverlay = document.getElementById("resetOverlay");
document.getElementById("resetProgress").addEventListener("click",()=>{
  resetOverlay.style.display = "flex";
});
document.getElementById("resetNo").addEventListener("click",()=>{
  resetOverlay.style.display = "none";
});
document.getElementById("resetYes").addEventListener("click",()=>{
  localStorage.clear();
  location.reload();
});

// ===== SKLEP =====
function openShop(){
  document.getElementById("shopOverlay").style.display = "flex";
}
function closeShop(){
  document.getElementById("shopOverlay").style.display = "none";
}
document.getElementById("openShop").addEventListener("click", openShop);

function buyShopItem(type){
  alert(`Kupiono pakiet: ${type.toUpperCase()} (mechanika luck możesz rozwinąć później)`);
}

// ===== START =====
updateUI();
</script>
</body>
</html>

