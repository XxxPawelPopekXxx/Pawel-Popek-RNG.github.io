<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pawe≈Ç RNG</title>
<style>
body { font-family: Arial; background:#121212; color:#fff; text-align:center; margin:0; padding:0; }
h1 { margin-top:20px; font-size:2em; }

button { padding:15px 30px; font-size:1.2em; margin:10px; cursor:pointer; border:none; border-radius:10px; transition:transform 0.2s; }
button:active { transform: scale(0.9); }

#rollButton { background-color:#4CAF50; color:white; }
#muteButton { background-color:#f44336; color:white; }
.upgradeButton { background-color:#2196F3; color:white; }

#resultImage { width:300px; height:300px; margin:20px auto; object-fit:cover; border-radius:15px; display:block; transition:all 0.1s; }
#resultText { font-size:1.5em; margin-top:10px; }
#chanceText, #rarityText { font-size:1.2em; margin-top:5px; }
#currency { margin-top:20px; font-size:1.3em; }
#upgrades { margin-top:20px; font-size:1em; display:flex; flex-wrap:wrap; justify-content:center; }
#upgrades button { margin:5px; }
#inventory, #history, #cooldownDisplay { margin-top:15px; font-size:1.1em; }
#history { max-height:200px; overflow-y:auto; border:1px solid #555; padding:10px; border-radius:10px; width:90%; margin:10px auto; background-color:#222; }

#stats { position:fixed; top:10px; right:10px; background-color:#222; border:1px solid #555; padding:10px; border-radius:10px; text-align:left; width:250px; font-size:0.9em; }

#resetOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:999; color:white; justify-content:center; align-items:center; }
#resetBox { background:#222; padding:30px; border-radius:15px; text-align:center; max-width:400px; }
#resetBox p { font-size:1.5em; color:red; margin-bottom:20px; }
#resetBox button { margin:10px; padding:10px 20px; font-size:1.2em; border-radius:10px; cursor:pointer; }
#resetYes { background-color:green; color:white; }
#resetNo { background-color:red; color:white; }

#volumeControl { margin-top:15px; }

#resetProgress { position:fixed; bottom:10px; left:10px; background-color:#f44336; color:white; padding:10px 15px; border-radius:10px; font-weight:bold; cursor:pointer; }
#chanceList { margin-top:10px; font-size:0.9em; color:#ccc; text-align:left; max-width:250px; margin-left:auto; margin-right:auto; }

#shopButton { background-color:#FF9800; color:white; margin-top:10px; }
#shopOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.75); z-index:1000; justify-content:center; align-items:center; }
#shopBox { background:#222; padding:30px; border-radius:15px; max-width:600px; max-height:80vh; overflow-y:auto; border:2px solid #FF9800; }
#shopBox h2 { color:#FF9800; margin-top:0; }
.shopItem { background:#333; padding:15px; margin:10px 0; border-radius:10px; border:1px solid #555; }
.shopItem h3 { color:#4CAF50; margin:5px 0; }
.shopItem p { margin:5px 0; font-size:0.9em; }
.shopItem button { background-color:#4CAF50; color:white; padding:10px 20px; border:none; border-radius:5px; cursor:pointer; margin-top:10px; }
.shopItem button:hover { background-color:#45a049; }
.shopItem button:disabled { background-color:#666; cursor:not-allowed; }
.shopItem .owned { color:#4CAF50; font-weight:bold; }
#closeShop { background-color:#f44336; color:white; padding:10px 20px; border:none; border-radius:5px; cursor:pointer; margin-top:20px; }

/* Custom Popup */
.custom-popup { 
  position: fixed; 
  top: 50%; 
  left: 50%; 
  transform: translate(-50%, -50%); 
  background: #222; 
  border: 2px solid #4CAF50; 
  border-radius: 15px; 
  padding: 30px 40px; 
  font-size: 1.3em; 
  z-index: 2000; 
  opacity: 1;
  transition: opacity 0.5s ease;
  box-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
  text-align: center;
  min-width: 300px;
}
.custom-popup.error { border-color: #f44336; box-shadow: 0 0 20px rgba(244, 67, 54, 0.5); }
.custom-popup.success { border-color: #4CAF50; box-shadow: 0 0 20px rgba(76, 175, 80, 0.5); }
.custom-popup.fadeout { opacity: 0; }
</style>
</head>
<body>

<h1>Pawe≈Ç RNG</h1>

<div id="stats">
  <div>Monety: <span id="statsCoins">0</span></div>
  <div>Autorzy: KoleszkaPP i its4iko</div>
  <div>Play Time: <span id="statsPlayTime">0s</span></div>
  <div>≈ÅƒÖczne losowania: <span id="statsRolls">0</span></div>
  <div>Mno≈ºnik szczƒô≈õcia: <span id="statsLuck">1.00x</span></div>
</div>

<img id="resultImage" src="photo.png" alt="Result">
<div id="resultText">Kliknij Roll</div>
<div id="chanceText"></div>
<div id="rarityText"></div>
<button id="rollButton">Roll</button>
<div id="cooldownDisplay">Cooldown: 3.0s</div>

<input type="range" min="0" max="100" value="100" id="volumeControl"> G≈Ço≈õno≈õƒá
<br>
<button id="muteButton">Mute/Unmute</button>

<div id="currency">Monety: <span id="coins">0</span></div>

<button id="shopButton">üõí SKLEP</button>

<div id="upgrades">
  <button class="upgradeButton" id="shortenCooldown">Skr√≥ƒá cooldown (-0.5s) 50 monet</button>
  <button class="upgradeButton" id="increaseChances">Ulepszenie szans 100 monet</button>
  <button class="upgradeButton" id="buyItem">Kup Tajemniczy Przedmiot 100 monet</button>
  <button class="upgradeButton" id="toggleAutoRoll">W≈ÇƒÖcz Auto-Roll 5000 monet</button>
</div>

<div id="inventory">Ekwipunek: brak</div>
<div id="history">Historia losowa≈Ñ:</div>

<div id="resetProgress">RESET PROGRESS</div>

<!-- Reset overlay -->
<div id="resetOverlay">
  <div id="resetBox">
    <p>Czy na pewno chcesz zresetowaƒá progres?</p>
    <button id="resetYes">Tak</button>
    <button id="resetNo">Nie</button>
  </div>
</div>

<!-- Shop overlay -->
<div id="shopOverlay">
  <div id="shopBox">
    <h2>üõí SKLEP PAWE≈ÅK√ìW</h2>
    <p style="color:#ccc;">Zbieraj wylosowane Pawe≈Çki i wymie≈Ñ je na potƒô≈ºne ulepszenia!</p>
    
    <div class="shopItem" id="luckyPawelItem">
      <h3>Lucky Pawel üçÄ</h3>
      <p>Mno≈ºnik szczƒô≈õcia: <strong>1.5x</strong></p>
      <p>Wymagane:</p>
      <ul style="text-align:left;">
        <li>gejmingowy pawe≈Ç: <span id="req1">0</span>/20</li>
        <li>pawe≈Ç prezydent: <span id="req2">0</span>/10</li>
        <li>Monety: <span id="req3">0</span>/1000</li>
      </ul>
      <button id="buyLuckyPawel">Kup Lucky Pawel</button>
    </div>

    <div class="shopItem" id="megaPawelItem">
      <h3>Mega Pawel üíé</h3>
      <p>Mno≈ºnik szczƒô≈õcia: <strong>2x</strong></p>
      <p>Wymagane:</p>
      <ul style="text-align:left;">
        <li>pawe≈Ç w zoltym hoodie: <span id="req4">0</span>/25</li>
        <li>funni pawe≈Ç: <span id="req5">0</span>/15</li>
        <li>Monety: <span id="req6">0</span>/2500</li>
      </ul>
      <button id="buyMegaPawel">Kup Mega Pawel</button>
    </div>

    <div class="shopItem" id="ultimatePawelItem">
      <h3>Ultimate Pawel üëë</h3>
      <p>Mno≈ºnik szczƒô≈õcia: <strong>3x</strong></p>
      <p>Wymagane:</p>
      <ul style="text-align:left;">
        <li>pawe≈Ç ok: <span id="req7">0</span>/50</li>
        <li>≈õwiƒÖteczny pawe≈Ç: <span id="req8">0</span>/20</li>
        <li>pawe≈Ç dostaje backshoty: <span id="req9">0</span>/2</li>
        <li>pawe≈Ç komunista: <span id="req10">0</span>/1</li>
        <li>Monety: <span id="req11">0</span>/5000</li>
      </ul>
      <button id="buyUltimatePawel">Kup Ultimate Pawel</button>
    </div>

    <button id="closeShop">Zamknij sklep</button>
  </div>
</div>

<div id="chanceList"></div>

<audio id="backgroundMusic"></audio>

<script>
// ===== DANE =====
const images = [
  {src:'photo.png',text:'gejmingowy pawe≈Ç',chance:1/2,rarity:'Common',reward:1},
  {src:'photo2.png',text:'pawe≈Ç prezydent',chance:1/4,rarity:'Uncommon',reward:5},
  {src:'photo3.png',text:'pawel w zoltym hoodie',chance:1/8,rarity:'Rare',reward:10},
  {src:'photo4.png',text:'funni pawe≈Ç',chance:1/16,rarity:'Epic',reward:20},
  {src:'photo5.png',text:'pawe≈Ç ok',chance:1/32,rarity:'Mythic',reward:40},
  {src:'photo6.png',text:'≈õwiƒÖteczny pawe≈Ç',chance:1/64,rarity:'Legendary',reward:80},
  {src:'photo7.png',text:'pawe≈Ç dostaje backshoty',chance:1/128,rarity:'Ultra Legendary',reward:160},
  {src:'photo8.png',text:'pawe≈Ç komunista',chance:1/256,rarity:'Ultra Legendary',reward:320},
  {src:'photo9.png',text:'≈öledziu',chance:0,rarity:'Secret',reward:500,requiresItem:'Tajemniczy Przedmiot'}
];

// ===== WCZYTYWANIE SZANS Z LOCALSTORAGE =====
const savedChances = localStorage.getItem('imagesChances');
if(savedChances){
  const chancesArr = JSON.parse(savedChances);
  images.forEach((img,i)=>{
    if(img.text !== '≈öledziu') {
      img.chance = chancesArr[i];
    }
  });
}

const musicFiles = ['music.mp3','music2.mp3','music3.mp3','music4.mp3','music5.mp3'];
const bgMusic = document.getElementById('backgroundMusic');
let musicStarted = false;
let currentMusicIndex = 0;

// Obs≈Çuga zako≈Ñczenia utworu - automatyczne prze≈ÇƒÖczanie
bgMusic.addEventListener('ended', () => {
  currentMusicIndex = (currentMusicIndex + 1) % musicFiles.length;
  bgMusic.src = musicFiles[currentMusicIndex];
  bgMusic.play().catch(err => console.log(err));
});

// ===== ZMIENNE =====
let coins = localStorage.getItem('coins') !== null ? parseInt(localStorage.getItem('coins')) : 30;
let inventory = localStorage.getItem('inventory') ? JSON.parse(localStorage.getItem('inventory')) : [];
let historyData = localStorage.getItem('historyData') ? JSON.parse(localStorage.getItem('historyData')) : {};
let cooldown = localStorage.getItem('cooldown') !== null ? parseInt(localStorage.getItem('cooldown')) : 3000;
let lastRoll = 0;
let totalRolls = localStorage.getItem('totalRolls') !== null ? parseInt(localStorage.getItem('totalRolls')) : 0;
let autoRollEnabled = localStorage.getItem('autoRollEnabled') !== null ? JSON.parse(localStorage.getItem('autoRollEnabled')) : false;
let autoRollInterval = null;
let playTime = localStorage.getItem('playTime') !== null ? parseInt(localStorage.getItem('playTime')) : 0;
let playTimeStart = Date.now();

// Mno≈ºniki szczƒô≈õcia ze sklepu
let luckMultiplier = localStorage.getItem('luckMultiplier') !== null ? parseFloat(localStorage.getItem('luckMultiplier')) : 1;
let ownedShopItems = localStorage.getItem('ownedShopItems') ? JSON.parse(localStorage.getItem('ownedShopItems')) : [];

// ===== CUSTOM POPUP =====
function showPopup(message, type = 'success') {
  const popup = document.createElement('div');
  popup.className = `custom-popup ${type}`;
  popup.textContent = message;
  document.body.appendChild(popup);
  
  setTimeout(() => {
    popup.classList.add('fadeout');
  }, 2000);
  
  setTimeout(() => {
    document.body.removeChild(popup);
  }, 2500);
}

// ===== FUNKCJE =====
function updateUI(){
  const elapsed = Math.floor((Date.now()-playTimeStart)/1000);
  document.getElementById('statsPlayTime').textContent = (playTime+elapsed)+'s';
  document.getElementById('inventory').textContent = inventory.length?`Ekwipunek: ${inventory.join(', ')}`:'Ekwipunek: brak';

  let historyHTML='';
  for(const[key,val] of Object.entries(historyData)){
    historyHTML+=`${key} (x${val})<br>`;
  }
  document.getElementById('history').innerHTML = historyHTML||'Historia losowa≈Ñ: brak';
  
  document.getElementById('coins').textContent = coins;
  document.getElementById('statsCoins').textContent = coins;
  document.getElementById('statsRolls').textContent = totalRolls;
  document.getElementById('statsLuck').textContent = luckMultiplier.toFixed(2) + 'x';

  // aktualizacja listy szans (bez ≈öledziu)
  const chanceList = document.getElementById('chanceList');
  chanceList.innerHTML = 'Aktualne szanse:<br>';
  images.forEach(img=>{
    if(img.text === '≈öledziu') return;
    chanceList.innerHTML += `${img.text}: ${(img.chance*100).toFixed(2)}%<br>`;
  });

  // zapis do localStorage
  localStorage.setItem('coins',coins);
  localStorage.setItem('inventory',JSON.stringify(inventory));
  localStorage.setItem('historyData',JSON.stringify(historyData));
  localStorage.setItem('cooldown',cooldown);
  localStorage.setItem('totalRolls',totalRolls);
}

// ===== COOLDOWN =====
setInterval(()=>{
  const now=Date.now();
  const diff=lastRoll?Math.max(0,cooldown-(now-lastRoll)):0;
  document.getElementById('cooldownDisplay').textContent=`Cooldown: ${(diff/1000).toFixed(1)}s`;
},100);

// ===== ROLL =====
function rollRNG(showRareAnimationOnly=false){
  const now=Date.now();
  if(now-lastRoll<cooldown) return;
  lastRoll=now;
  totalRolls++;

  // Oblicz szansƒô na ≈öledzia co 500 rolli
  const sledzMilestone = Math.floor(totalRolls / 500);
  const sledzChance = sledzMilestone > 0 ? 1/100 : 0;
  
  // Aktualizuj szansƒô ≈öledzia w tablicy images
  const sledzImage = images.find(img => img.text === '≈öledziu');
  if(sledzImage) {
    sledzImage.chance = sledzChance;
  }

  const entries=[];
  images.forEach(img=>{
    if(img.requiresItem && !inventory.includes(img.requiresItem)) return;

    let count;
    if(img.text === '≈öledziu') {
      // ≈öled≈∫ nie jest modyfikowany przez luck multiplier
      count = Math.floor(img.chance * 1000000);
    } else {
      count = Math.floor(img.chance * 1000000 * luckMultiplier);
      if(inventory.length > 0) count = Math.floor(count * 1.05);
    }
    
    for(let i = 0; i < count; i++) entries.push(img);
  });

  const imgElem=document.getElementById('resultImage');
  const textElem=document.getElementById('resultText');
  const chanceElem=document.getElementById('chanceText');
  const rarityElem=document.getElementById('rarityText');

  let elapsedAnim=0;
  const animSpeed=50;
  const totalDuration=1000;
  const interval=setInterval(()=>{
    const temp = images[Math.floor(Math.random()*images.length)];

    imgElem.src=temp.src;
    textElem.textContent=temp.text;
    if(temp.chance > 0) {
      chanceElem.textContent=`Szansa: 1/${Math.round(1/temp.chance)}`;
    } else {
      chanceElem.textContent='Szansa: ???';
    }
    rarityElem.textContent=`Rzadko≈õƒá: ${temp.rarity}`;
    if(temp.rarity!=='Common' && temp.rarity!=='Uncommon'){
      imgElem.style.transform=`scale(${1+Math.random()*0.2}) rotate(${(Math.random()-0.5)*20}deg)`;
      imgElem.style.filter=`brightness(${1+Math.random()*0.5})`;
    } else { imgElem.style.transform='scale(1) rotate(0deg)'; imgElem.style.filter='brightness(1)'; }

    elapsedAnim+=animSpeed;
    if(elapsedAnim>=totalDuration){
      clearInterval(interval);
      const selected=entries[Math.floor(Math.random()*entries.length)];
      imgElem.src=selected.src;
      textElem.textContent=selected.text;
      if (selected.chance <= 0 || selected.chance > 1) {
        chanceElem.textContent = 'Szansa: ???';
      } else {
        chanceElem.textContent = `Szansa: 1/${Math.round(1 / selected.chance)}`;
      }

      rarityElem.textContent=`Rzadko≈õƒá: ${selected.rarity}`;
      let reward=selected.reward;
      if(inventory.length>0) reward=Math.floor(reward*(1+0.05*inventory.length));
      coins+=reward;
      if(historyData[selected.text]) historyData[selected.text]++;
      else historyData[selected.text]=1;
      imgElem.style.transform='scale(1) rotate(0deg)';
      imgElem.style.filter='brightness(1)';
      
      // Popup dla ≈öledzia
      if(selected.text === '≈öledziu') {
        showPopup('üêü WYLOSOWA≈ÅE≈ö ≈öLEDZIA! üêü', 'success');
      }
      
      updateUI();
    }
  },animSpeed);
}

// ===== BUTTONS =====
document.getElementById('rollButton').addEventListener('click', async ()=>{
  if(!musicStarted){
    currentMusicIndex = Math.floor(Math.random()*musicFiles.length);
    bgMusic.src = musicFiles[currentMusicIndex];
    try{ await bgMusic.play(); musicStarted=true;}catch(err){console.log(err);}
  }
  rollRNG(true);
});

document.getElementById('muteButton').addEventListener('click',()=>{ bgMusic.muted=!bgMusic.muted; });
document.getElementById('volumeControl').addEventListener('input',(e)=>{ bgMusic.volume=e.target.value/100; });

// ===== ULEPSZENIA =====
document.getElementById('shortenCooldown').addEventListener('click',()=>{
  if(coins>=50 && cooldown>1000){ 
    coins-=50; 
    cooldown=Math.max(1000,cooldown-500); 
    updateUI(); 
    showPopup(`Cooldown skr√≥cony! Teraz ${(cooldown/1000).toFixed(1)}s`, 'success');
  } else if(cooldown <= 1000) {
    showPopup('Nie mo≈ºna ju≈º ulepszyƒá cooldowna!', 'error');
  } else {
    showPopup('Nie masz wystarczajƒÖco monet!', 'error');
  }
});

document.getElementById('increaseChances').addEventListener('click',()=>{
  if(coins>=100){
    coins-=100;
    images.forEach(img=>{
      if(img.text === '≈öledziu') return; // Nie modyfikujemy szansy ≈öledzia
      if(img.text==='gejmingowy pawe≈Ç' || img.text==='pawe≈Ç prezydent'){
        img.chance = Math.max(0.01, img.chance*0.95);
      } else {
        img.chance = Math.min(1, Math.round(img.chance*1.05*1000)/1000);
      }
    });
    localStorage.setItem('imagesChances', JSON.stringify(images.map(img=>img.chance)));
    updateUI(); 
    showPopup('Szanse zosta≈Çy ulepszone!', 'success');
  } else {
    showPopup('Nie masz wystarczajƒÖco monet!', 'error');
  }
});

document.getElementById('buyItem').addEventListener('click',()=>{
  if(coins>=100){
    if(!inventory.includes('Tajemniczy Przedmiot')){ 
      coins-=100; 
      inventory.push('Tajemniczy Przedmiot'); 
      updateUI(); 
      showPopup('Tajemniczy Przedmiot dodany!', 'success');
    } else {
      showPopup('Masz ju≈º Tajemniczy Przedmiot!', 'error');
    }
  } else {
    showPopup('Nie masz wystarczajƒÖco monet!', 'error');
  }
});

document.getElementById('toggleAutoRoll').addEventListener('click',()=>{
  if(autoRollEnabled){ 
    clearInterval(autoRollInterval); 
    autoRollEnabled=false; 
    updateUI(); 
    showPopup('Auto-Roll wy≈ÇƒÖczony', 'success');
  } else { 
    if(coins>=5000){ 
      coins-=5000; 
      autoRollEnabled=true; 
      autoRollInterval=setInterval(()=>rollRNG(true),1500); 
      updateUI(); 
      showPopup('Auto-Roll w≈ÇƒÖczony', 'success');
    } else {
      showPopup('Nie masz wystarczajƒÖco monet na Auto-Roll!', 'error');
    }
  }
});

// ===== RESET =====
const resetOverlay = document.getElementById('resetOverlay');
const resetYes = document.getElementById('resetYes');
const resetNo = document.getElementById('resetNo');

document.getElementById('resetProgress').addEventListener('click',()=>{ resetOverlay.style.display='flex'; });
resetNo.addEventListener('click',()=>{ resetOverlay.style.display='none'; });
resetYes.addEventListener('click',()=>{ localStorage.clear(); location.reload(); });

// ===== SKLEP =====
const shopOverlay = document.getElementById('shopOverlay');
const shopButton = document.getElementById('shopButton');
const closeShop = document.getElementById('closeShop');

shopButton.addEventListener('click', () => {
  updateShopUI();
  shopOverlay.style.display = 'flex';
});

closeShop.addEventListener('click', () => {
  shopOverlay.style.display = 'none';
});

function updateShopUI() {
  // Lucky Pawel
  const gejmingowy = historyData['gejmingowy pawe≈Ç'] || 0;
  const prezydent = historyData['pawe≈Ç prezydent'] || 0;
  document.getElementById('req1').textContent = gejmingowy;
  document.getElementById('req2').textContent = prezydent;
  document.getElementById('req3').textContent = coins;
  
  const luckyBtn = document.getElementById('buyLuckyPawel');
  if(ownedShopItems.includes('Lucky Pawel')) {
    luckyBtn.disabled = true;
    luckyBtn.textContent = '‚úì KUPIONE';
  } else {
    luckyBtn.disabled = !(gejmingowy >= 20 && prezydent >= 10 && coins >= 1000);
  }

  // Mega Pawel
  const zolty = historyData['pawel w zoltym hoodie'] || 0;
  const funni = historyData['funni pawe≈Ç'] || 0;
  document.getElementById('req4').textContent = zolty;
  document.getElementById('req5').textContent = funni;
  document.getElementById('req6').textContent = coins;
  
  const megaBtn = document.getElementById('buyMegaPawel');
  if(ownedShopItems.includes('Mega Pawel')) {
    megaBtn.disabled = true;
    megaBtn.textContent = '‚úì KUPIONE';
  } else {
    megaBtn.disabled = !(zolty >= 25 && funni >= 15 && coins >= 2500);
  }

  // Ultimate Pawel
  const ok = historyData['pawe≈Ç ok'] || 0;
  const swiateczny = historyData['≈õwiƒÖteczny pawe≈Ç'] || 0;
  const backshoty = historyData['pawe≈Ç dostaje backshoty'] || 0;
  const komunista = historyData['pawe≈Ç komunista'] || 0;
  document.getElementById('req7').textContent = ok;
  document.getElementById('req8').textContent = swiateczny;
  document.getElementById('req9').textContent = backshoty;
  document.getElementById('req10').textContent = komunista;
  document.getElementById('req11').textContent = coins;
  
  const ultimateBtn = document.getElementById('buyUltimatePawel');
  if(ownedShopItems.includes('Ultimate Pawel')) {
    ultimateBtn.disabled = true;
    ultimateBtn.textContent = '‚úì KUPIONE';
  } else {
    ultimateBtn.disabled = !(ok >= 50 && swiateczny >= 20 && backshoty >= 2 && komunista >= 1 && coins >= 5000);
  }
}

document.getElementById('buyLuckyPawel').addEventListener('click', () => {
  const gejmingowy = historyData['gejmingowy pawe≈Ç'] || 0;
  const prezydent = historyData['pawe≈Ç prezydent'] || 0;
  
  if(gejmingowy >= 20 && prezydent >= 10 && coins >= 1000 && !ownedShopItems.includes('Lucky Pawel')) {
    historyData['gejmingowy pawe≈Ç'] -= 20;
    historyData['pawe≈Ç prezydent'] -= 10;
    coins -= 1000;
    luckMultiplier *= 1.5;
    ownedShopItems.push('Lucky Pawel');
    
    localStorage.setItem('luckMultiplier', luckMultiplier);
    localStorage.setItem('ownedShopItems', JSON.stringify(ownedShopItems));
    
    updateUI();
    updateShopUI();
    showPopup('üçÄ Lucky Pawel zakupiony! Mno≈ºnik: ' + luckMultiplier.toFixed(2) + 'x', 'success');
  } else {
    showPopup('Brak wymaganych zasob√≥w!', 'error');
  }
});

document.getElementById('buyMegaPawel').addEventListener('click', () => {
  const zolty = historyData['pawel w zoltym hoodie'] || 0;
  const funni = historyData['funni pawe≈Ç'] || 0;
  
  if(zolty >= 25 && funni >= 15 && coins >= 2500 && !ownedShopItems.includes('Mega Pawel')) {
    historyData['pawel w zoltym hoodie'] -= 25;
    historyData['funni pawe≈Ç'] -= 15;
    coins -= 2500;
    luckMultiplier *= 2;
    ownedShopItems.push('Mega Pawel');
    
    localStorage.setItem('luckMultiplier', luckMultiplier);
    localStorage.setItem('ownedShopItems', JSON.stringify(ownedShopItems));
    
    updateUI();
    updateShopUI();
    showPopup('üíé Mega Pawel zakupiony! Mno≈ºnik: ' + luckMultiplier.toFixed(2) + 'x', 'success');
  } else {
    showPopup('Brak wymaganych zasob√≥w!', 'error');
  }
});

document.getElementById('buyUltimatePawel').addEventListener('click', () => {
  const ok = historyData['pawe≈Ç ok'] || 0;
  const swiateczny = historyData['≈õwiƒÖteczny pawe≈Ç'] || 0;
  const backshoty = historyData['pawe≈Ç dostaje backshoty'] || 0;
  const komunista = historyData['pawe≈Ç komunista'] || 0;
  
  if(ok >= 50 && swiateczny >= 20 && backshoty >= 2 && komunista >= 1 && coins >= 5000 && !ownedShopItems.includes('Ultimate Pawel')) {
    historyData['pawe≈Ç ok'] -= 50;
    historyData['≈õwiƒÖteczny pawe≈Ç'] -= 20;
    historyData['pawe≈Ç dostaje backshoty'] -= 2;
    historyData['pawe≈Ç komunista'] -= 1;
    coins -= 5000;
    luckMultiplier *= 3;
    ownedShopItems.push('Ultimate Pawel');
    
    localStorage.setItem('luckMultiplier', luckMultiplier);
    localStorage.setItem('ownedShopItems', JSON.stringify(ownedShopItems));
    
    updateUI();
    updateShopUI();
    showPopup('üëë Ultimate Pawel zakupiony! Mno≈ºnik: ' + luckMultiplier.toFixed(2) + 'x', 'success');
  } else {
    showPopup('Brak wymaganych zasob√≥w!', 'error');
  }
});

// ===== AUTO-SAVE =====
setInterval(()=>{
  playTime += 10;
  localStorage.setItem('playTime', playTime);
  localStorage.setItem('autoRollEnabled', autoRollEnabled);
}, 10000);

// ===== INIT =====
updateUI();

// Przywr√≥ƒá auto-roll je≈õli by≈Ço w≈ÇƒÖczone
if(autoRollEnabled) {
  autoRollInterval = setInterval(() => rollRNG(true), 1500);
}

// Inicjalizacja g≈Ço≈õno≈õci
bgMusic.volume = document.getElementById('volumeControl').value / 100;
</script>
</body>
</html>
